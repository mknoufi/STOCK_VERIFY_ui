# SonarQube Configuration for Stock Verify
# Documentation: https://docs.sonarqube.org/latest/analyzing-source-code/scanners/sonarscanner/

# ----- Server Configuration -----
sonar.host.url=https://sonarcloud.io

# ----- Project Identification -----
sonar.projectKey=stock-verify
sonar.projectName=Stock Verify
sonar.projectVersion=1.0.0
sonar.organization=mknoufi

# ----- Source Configuration -----
# Focus on core application code only to stay within free tier limits
sonar.sources=backend/api,backend/services,backend/auth,backend/core,frontend/src/components,frontend/src/services,frontend/src/store,frontend/src/domains,frontend/src/hooks,frontend/src/theme
sonar.tests=backend/tests,frontend/__tests__,frontend/tests

# ----- Language-specific Settings -----

# Python Backend
sonar.python.version=3.10,3.11
sonar.python.coverage.reportPaths=backend/coverage.xml
sonar.python.pylint.reportPaths=backend/pylint-report.txt
sonar.python.bandit.reportPaths=backend/bandit-report.json
sonar.python.ruff.reportPaths=backend/ruff-report.json

# TypeScript/JavaScript Frontend
sonar.typescript.lcov.reportPaths=frontend/coverage/lcov.info
sonar.javascript.lcov.reportPaths=frontend/coverage/lcov.info
sonar.eslint.reportPaths=frontend/eslint-report.json

# ----- Exclusions -----
# Files and directories to exclude from analysis
# Aggressive exclusions to stay within SonarCloud free tier limits
sonar.exclusions=\
  **/node_modules/**,\
  **/__pycache__/**,\
  **/venv/**,\
  **/.venv/**,\
  **/dist/**,\
  **/build/**,\
  **/.expo/**,\
  **/coverage/**,\
  **/*.test.ts,\
  **/*.test.tsx,\
  **/*.spec.ts,\
  **/*.spec.tsx,\
  **/test_*.py,\
  **/*_test.py,\
  **/tests/**,\
  **/migrations/**,\
  **/scripts/**,\
  **/docs/**,\
  **/*.md,\
  **/*.json,\
  **/*.yml,\
  **/*.yaml,\
  **/reference/**,\
  **/agents/**,\
  **/cooking_agent/**,\
  **/templates/**,\
  **/specs/**,\
  **/skills/**,\
  **/k8s/**,\
  **/nginx/**,\
  **/ios/**,\
  **/*.config.js,\
  **/*.config.ts,\
  **/*.setup.js,\
  **/metro.config.js,\
  **/babel.config.js,\
  **/jest.config.js,\
  **/jest.setup.js,\
  **/*.d.ts,\
  **/frontend/app.json,\
  **/backend/data/**,\
  **/*.mv2,\
  **/*.lock

# Test file exclusions (don't analyze test files as production code)
sonar.test.exclusions=\
  **/node_modules/**,\
  **/__pycache__/**,\
  **/venv/**

# Coverage exclusions (files to exclude from coverage calculation)
sonar.coverage.exclusions=\
  **/tests/**,\
  **/*.test.ts,\
  **/*.test.tsx,\
  **/*.spec.ts,\
  **/*.spec.tsx,\
  **/test_*.py,\
  **/*_test.py,\
  **/conftest.py,\
  **/scripts/**,\
  **/migrations/**,\
  frontend/metro.config.js,\
  frontend/babel.config.js,\
  frontend/jest.config.js

# Duplicate code detection exclusions
sonar.cpd.exclusions=\
  **/*.test.ts,\
  **/*.test.tsx,\
  **/test_*.py,\
  **/tests/**

# ----- Quality Gate Settings -----
# Encoding
sonar.sourceEncoding=UTF-8

# ----- Issue Settings -----
# Security hotspots to skip review (use with caution)
# sonar.issue.ignore.multicriteria=e1
# sonar.issue.ignore.multicriteria.e1.ruleKey=python:S4790
# sonar.issue.ignore.multicriteria.e1.resourceKey=**/*

# ----- External Analyzers -----
# Import external issues from other tools (only if files exist)
# Generate reports first with: make sonar-reports
# sonar.externalIssuesReportPaths=backend/bandit-report.json

# ----- Branch Analysis (requires Developer Edition+) -----
# sonar.branch.name=${GITHUB_REF_NAME}
